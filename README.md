# Рекомендательная система для социальной сети
Придумана условная социальная сеть, со следующим функционалом: можно отправлять друг другу письма, создавать сообщества, аналогичные группам в известных сетях, и в этих сообществах публиковать посты. При регистрации пользователи должны заполнять данные по своему профилю, которые хранятся в поднятой postgres database. Так же платформа обладает лентой, которую пользователи могут листать и просматривать случайные записи случайных сообществ. Если пост нравится, можно поддержать автора и поставить like. Все действия пользователей сохраняются, каждая их активность, связанная с просмотром постов, тоже записывается в базу.
В рамках проекта необходимо построить рекомендательный сервис постов в социальной сети

## Задача
* Провести разработку рекомендательного сервиса, который на базе данных о пользователях и постах будет предлагать топ-5 публикаций для пользователя, с большей вероятностью которые юзер лайкнет
* При этом уложиться в рамки требований по метрикам и техническим ограничениям (о них далее)

## Требования по работе рекомендательного сервиса
* Скорость работы сервиса. Среднее время работы одного запроса должно быть не более __~0,5 секунд__. 
* Установлены ограничения по памяти: не больше, чем __~4 гб RAM__ на запуск 
* Установлены ограничения на качество модели: 
	* На 2-м этапе проекта HitRate@5 должен быть больше __0.52__
	* На 3-м этапе проекта HitRate@5 должен быть больше __0.57__

 ## Этапы разработки
1. Подготовка основы сервиса на базе FAST API (виртуальное окружение, установка пакетов, pydentic схема)
2. Выгрузка данных, EDA, использование моделей классического машинного обучения, настройка сервиса
   
   Произвел выгрузку данных с проверкой значений на пропуски, типы данных, добавлением доп. фичей по времени и проверки взаимосвязи с таргетным значением. По EDA выделил фичи, от которых можно отказаться при дальнейшем обучении. Добавил дополнительные фичи по текстам постов: tf-idf с агрегатными значениями. Выполнил предобработку фичей и валидацию трейн/тест перед обучением

4. Доработка модели и сервиса (используя эмбединги, deep learning)
5. Построение отдельного сервиса для использования A/B тестирования (для примера будут взяты модели из 2-го и 3-го этапов разработки)

## Доступное окружение для сервиса (для чекера проекта)
```
fastapi==0.75.1
pandas==1.4.2
sqlalchemy==1.4.35
requests==2.27.1
catboost==1.0.6
numpy==1.22.4
pydantic==1.9.1
scikit_learn==1.1.1
lightgbm==2.0.3
xgboost==1.6.1
psycopg2-binary==2.9.3
uvicorn==0.16.0
category-encoders==2.5.0
loguru==0.6.0
implicit==0.5.2
lightfm==1.16
```

## Описание основных файлов из проекта
* "app.py" - основной сервис для 1-3 этапов
* "check_eda_learn.ipynb" - Jupiter Notebook с проверкой данных, EDA, обучению моделей для 2-3 этапов
* "emb-posts-pretrain.ipynb" - Jupiter Notebook с подготовкой эмбедингов постов для 3-го этапа
* "app_ab.py" - сервис для использования a/b тестов
